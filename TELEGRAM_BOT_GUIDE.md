# Telegram Bot 使用指南

## 🎉 新功能介绍

你的OpenClaw Telegram Bot现在支持完整的命令系统、交互式菜单和专业的用户界面！

---

## 📋 命令列表

### 基础命令

| 命令 | 功能 | 描述 |
|------|------|------|
| `/start` | 🚀 开始使用 | 显示欢迎消息和快捷键盘 |
| `/help` | 📋 帮助信息 | 查看所有可用命令 |
| `/new` | 🆕 新对话 | 清除历史，开始新对话 |
| `/status` | 📊 状态查询 | 查看机器人运行状态 |
| `/model` | 🤖 切换模型 | 选择不同的AI模型 |

---

## 🎯 功能特性

### 1. 欢迎界面 (`/start`)

使用 `/start` 命令将显示：
- 🎨 精美的欢迎消息（Markdown格式）
- ⌨️ 快捷键盘，包含常用操作
- 📝 快速开始指引

**快捷键盘按钮**：
```
💬 新对话 | 📊 状态
❓ 帮助   | 🤖 切换模型
```

### 2. 帮助系统 (`/help`)

获取完整的命令列表和使用技巧：
```
📋 可用命令

/start - 显示欢迎信息
/help - 显示此帮助信息
/new - 开始新对话（清除历史）
/status - 查看机器人状态
/model - 切换 AI 模型

💡 提示
• 直接发送消息开始对话
• 支持发送图片、文件等
• 可以进行多轮对话
```

### 3. 新对话 (`/new`)

开始新对话时会显示确认按钮：
- ✅ **确认** - 清除历史记录
- ❌ **取消** - 保持当前对话

这是一个**内联键盘**示例，点击按钮即可执行操作。

### 4. 状态查询 (`/status`)

查看机器人当前状态：
```
📊 机器人状态

🤖 当前模型: google/gemini-3-pro-preview
✅ 状态: 运行中
💬 会话: 活跃
📡 连接: 正常
```

### 5. 模型切换 (`/model`)

使用内联键盘选择AI模型：
- 🌟 Gemini Pro (当前)
- 🧠 Claude 3.5 Sonnet
- ⚡ GPT-4
- 🔥 GPT-4 Turbo

点击按钮即可切换模型，新消息将使用所选模型。

---

## 🎨 交互功能

### 内联键盘 (Inline Keyboard)

内联键盘直接显示在消息下方，点击后执行操作：
- ✅ 确认/取消操作
- 🤖 选择模型
- 📊 查看更多选项

**特点**：
- 按钮直接嵌入消息
- 点击后自动更新
- 支持多级菜单

### 回复键盘 (Reply Keyboard)

回复键盘显示在输入框上方，提供快捷操作：
```
┌──────────────┬──────────────┐
│  💬 新对话   │   📊 状态    │
├──────────────┼──────────────┤
│  ❓ 帮助     │  🤖 切换模型 │
└──────────────┴──────────────┘
```

**特点**：
- 始终可见
- 快速访问常用功能
- 自动调整大小

---

## 🌟 使用示例

### 示例1：开始使用

```
用户: /start
Bot: 👋 欢迎使用 OpenClaw AI 助手！
     
     我是一个强大的 AI 助手，可以帮你：
     • 💬 智能对话交流
     • 📝 处理文档和文件
     • 🔍 搜索和查询信息
     • 🛠️ 执行各种任务
     
     发送任何消息开始对话，或使用 /help 查看更多命令。
     
     [显示快捷键盘]
```

### 示例2：切换模型

```
用户: /model
Bot: 🤖 选择 AI 模型
     
     当前模型: google/gemini-3-pro-preview
     
     选择要使用的模型：
     
     [🌟 Gemini Pro (当前)]
     [🧠 Claude Sonnet   ]
     [⚡ GPT-4           ]
     [🔥 GPT-4 Turbo     ]

用户: [点击 Claude Sonnet]
Bot: ✅ 模型已切换
     
     现在使用: Claude 3.5 Sonnet
     模型ID: claude-3-5-sonnet-20241022
     
     新消息将使用此模型
```

### 示例3：新对话

```
用户: /new
Bot: 🆕 开始新对话
     
     这将清除当前对话历史记录。
     你确定要继续吗？
     
     [✅ 确认] [❌ 取消]

用户: [点击 ✅ 确认]
Bot: ✅ 新对话已开始
     
     对话历史已清除。发送消息开始新的对话！
```

---

## 💡 高级技巧

### 1. Markdown 格式

Bot 支持发送 Markdown 格式消息：
- **粗体文本**
- *斜体文本*
- `代码块`
- [链接](https://example.com)

### 2. 快捷键盘使用

点击快捷键盘上的按钮相当于：
- 💬 新对话 = `/new`
- 📊 状态 = `/status`
- ❓ 帮助 = `/help`
- 🤖 切换模型 = `/model`

### 3. 普通消息

除了命令，你可以直接发送：
- 📝 文本消息
- 🖼️ 图片
- 📁 文件
- 🎤 语音

Bot 会使用 Gemini API 智能回复。

---

## 🔧 重启后测试

### 1. 停止当前 Gateway

```bash
Ctrl+C
```

### 2. 重启 Gateway

```bash
cd /Users/openjavis/Desktop/xopen/openclaw-python
uv run openclaw gateway run
```

### 3. 在 Telegram 测试

1. 打开与你的 Bot 的对话
2. 输入 `/start`
3. 查看欢迎消息和快捷键盘
4. 尝试各种命令

---

## 📸 预期效果

### 命令菜单

在 Telegram 输入框左侧，点击 `/` 按钮会显示：
```
🚀 start - 开始使用机器人
📋 help - 查看帮助信息
🆕 new - 开始新对话
📊 status - 查看状态
🤖 model - 切换AI模型
```

### 快捷键盘

在输入框上方显示：
```
┌──────────────────────────────────┐
│  💬 新对话      📊 状态           │
│  ❓ 帮助        🤖 切换模型       │
└──────────────────────────────────┘
```

### 内联按钮

消息下方显示可点击的按钮，如：
```
┌─────────────────────────────┐
│  🤖 选择 AI 模型             │
│                              │
│  当前模型: gemini-3-pro     │
│                              │
│  选择要使用的模型：           │
└─────────────────────────────┘
  [🌟 Gemini Pro (当前)]
  [🧠 Claude Sonnet   ]
  [⚡ GPT-4           ]
  [🔥 GPT-4 Turbo     ]
```

---

## 🎯 与 OpenClaw TypeScript 的对齐

现在你的 Python 实现与 OpenClaw 官方 TypeScript 版本对齐：

| 功能 | TypeScript | Python | 状态 |
|------|------------|--------|------|
| 命令系统 | ✅ | ✅ | 完全对齐 |
| 内联键盘 | ✅ | ✅ | 完全对齐 |
| 回复键盘 | ✅ | ✅ | 完全对齐 |
| Markdown | ✅ | ✅ | 完全对齐 |
| 命令注册 | ✅ | ✅ | 完全对齐 |
| 菜单按钮 | ✅ | ✅ | 完全对齐 |

参考：
- Telegram Bot API: https://core.telegram.org/api
- OpenClaw TypeScript: `src/telegram/bot-native-commands.ts`

---

## 📝 总结

你的 Telegram Bot 现在具备：

✅ **专业命令系统**
- 5个核心命令
- 自动注册到 Telegram
- 命令自动补全

✅ **交互式界面**
- 内联键盘（按钮式菜单）
- 回复键盘（快捷操作）
- Markdown 格式化消息

✅ **用户友好**
- 中文界面
- 表情符号
- 清晰的提示信息

✅ **功能完整**
- 模型切换
- 会话管理
- 状态查询

---

**🎉 立即重启 Gateway 并在 Telegram 中体验新功能！**

*生成时间: 2026-02-12*
